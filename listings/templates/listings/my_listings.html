<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Мои объявления</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        button {
            padding: 5px 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button.delete {
            background-color: #f44336;
        }
        button.toggle-status {
            background-color: #FFA500;
        }
        button:hover {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <h1>Мои объявления</h1>
    <table>
        <tr>
            <th>Название</th>
            <th>Описание</th>
            <th>Местоположение</th>
            <th>Цена</th>
            <th>Комнаты</th>
            <th>Тип недвижимости</th>
            <th>Статус</th>
            <th>Владелец</th>
            <th>Создано</th>
            <th>Обновлено</th>
            <th>Редактировать</th>
            <th>Удалить</th>
            <th>Изменить статус</th> <!-- Новый столбец для управления статусом -->
        </tr>
        {% for listing in listings %}
            <tr>
                <td>{{ listing.title }}</td>
                <td>{{ listing.description }}</td>
                <td>{{ listing.location }}</td>
                <td>{{ listing.price }}</td>
                <td>{{ listing.rooms }}</td>
                <td>{{ listing.property_type }}</td>
                <td>{% if listing.status %}Активно{% else %}Неактивно{% endif %}</td> <!-- Отображение статуса -->
                <td>{{ listing.owner }}</td>
                <td>{{ listing.created_at }}</td>
                <td>{{ listing.updated_at }}</td>
                <td>
                    <button>
                        <a href="{% url 'listings:edit_listing' listing.pk %}" style="color: white; text-decoration: none;">Редактировать</a>
                    </button>
                </td>
                <td>
                    <form action="{% url 'listings:delete_listing' listing.pk %}" method="post" onsubmit="return confirm('Вы уверены, что хотите удалить это объявление?');">
                        {% csrf_token %}
                        <button type="submit" class="delete">Удалить</button>
                    </form>
                </td>
                <td>
                    <form action="{% url 'listings:toggle_listing_status' listing.pk %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="toggle-status">
                            {% if listing.status %}
                                Деактивировать
                            {% else %}
                                Активировать
                            {% endif %}
                        </button>
                    </form>
                </td> <!-- Кнопка для переключения статуса -->
            </tr>
        {% empty %}
            <tr>
                <td colspan="13">Нет объявлений.</td>
            </tr>
        {% endfor %}
    </table>
</body>
</html>
